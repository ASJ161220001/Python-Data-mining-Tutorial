# 统计学的Python实现-020：已知样本比例的抽样分布

> **作者**：长行
>
> **时间**：2019.03.24

## 统计学解释

已知样本比例的抽样分布计算是一种理想的抽样分布算法，通常用来学习抽样理论。其已知的信息为总体的分布特征，并求在抽取一定容量的样本后，样本的分布特征。

例如：已知1980年美国总统选举中，有3490万选民支持民主党，有4320万选民支持共和党。求事先随机抽取150位选民能够成功预测共和党胜出的概率。

这实际上是二项随机变量的概率计算的一种实际应用。抽取的样本服从二项分布，X～b(n,p)，其中n为样本量，p为要研究的事件发生的概率。因此可以使用二项分布的公式，要研究的事件发生的次数为k的概率：
$$
P\{X=k\}=C^{k}_{n}p^{k}(1-p)^{n-k},\qquad{k=0,1,2,...,n}
$$

## 实现代码

参考二项随机变量的概率计算的计算方法，我们有如下的函数计算要研究的事件发生的次数大于等于x的概率：

```python
def binomial_distribution_morethan(p, n, x):
    count = 0
    for i in range(x, n, 1):
        c = math.factorial(n) / math.factorial(n - i) / math.factorial(i)
        count += c * (p ** i) * ((1 - p) ** (n - i))
    return count
```

其中参数p为要研究的事件发生的概率，n为抽取的样本容量，x为要研究的事件发生的次数。

例如在1980年美国总统选举的样例中：p为抽取的选民支持共和党的概率，其概率为4320/(4320+3490)=0.5531；n为抽取的样本量150；x为预测共和党胜出至少需要样本中支持共和党的人数，即76。因此调用函数的方法为：

```python
binomial_distribution_morethan(0.5531,150,76)
```

其结果为：

```
0.8896861732667398
```

## 实际应用

在一些特殊情况下，我们会事先进行抽样并预测总体分布情况，而事后我们又可以得到总体的确切的分布情况，例如选举。

在这种情况下，我们可以依据事后得到的总体分布情况，此计算出之前我们抽取的样本被抽出的概率，并依据实际推断原理检验抽样方法是否存在漏洞。

例如在1980年美国总统选举的样例中，如果我们抽取的样本显示民主党将获胜，那么抽出这样样本的概率仅有11%，显然我们就需要分析我们的抽样方法是否存在问题了。